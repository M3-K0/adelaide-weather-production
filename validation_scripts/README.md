# Adelaide Weather Validation Scripts

This directory contains comprehensive validation scripts for the Adelaide Weather Forecasting System. These scripts are automatically created and used by the deployment automation system.

## Scripts Overview

### ğŸ” `prerequisites_check.sh`
**Purpose:** Comprehensive validation of system prerequisites before deployment
- Validates Docker and Docker Compose installation
- Checks system resources (memory, disk, CPU)
- Verifies required ports availability
- Tests network connectivity
- Validates required tools and file structure
- Checks FAISS data integrity

**Usage:**
```bash
./validation_scripts/prerequisites_check.sh
```

**Exit Codes:**
- `0`: All prerequisites met
- `1`: Critical prerequisites missing

### ğŸ¥ `health_monitor.py`
**Purpose:** Comprehensive health monitoring for all system components
- Monitors Docker containers and their health status
- Tests all service endpoints (API, Frontend, Nginx, Monitoring)
- Validates FAISS indices integrity
- Checks system resource usage
- Provides detailed health reports
- Supports continuous monitoring with alerting

**Usage:**
```bash
# Single health check
python validation_scripts/health_monitor.py

# Continuous monitoring
python validation_scripts/health_monitor.py --continuous --interval 60

# Save health report to file
python validation_scripts/health_monitor.py --save-report
```

**Features:**
- Real-time health status dashboard
- JSON health reports for automation
- Configurable monitoring intervals
- Alert thresholds for consecutive failures
- Resource usage monitoring

### ğŸ§ª `end_to_end_test.sh`
**Purpose:** Complete end-to-end testing of system functionality
- Tests connectivity (HTTP, HTTPS, Frontend)
- Validates API functionality (health, documentation, OpenAPI)
- Tests FAISS and forecast capabilities
- Verifies monitoring stack integration
- Checks security headers and CORS
- Performance and stress testing

**Usage:**
```bash
./validation_scripts/end_to_end_test.sh
```

**Test Categories:**
- **Connectivity Tests:** Basic HTTP/HTTPS and frontend loading
- **API Tests:** Health endpoints, documentation, schema validation
- **FAISS & Forecast Tests:** ML model functionality and analog search
- **Monitoring Tests:** Metrics endpoints and monitoring stack
- **Security Tests:** Headers, CORS, error handling, data validation
- **Performance Tests:** Response times and concurrent request handling

**Exit Codes:**
- `0`: All tests passed or >80% success rate
- `1`: Multiple test failures (<80% success rate)

### ğŸ”§ `system_validation.sh`
**Purpose:** System-level validation (auto-generated by deployment script)
- Validates all containers are running
- Tests critical API endpoints
- Verifies FAISS health endpoints
- Checks frontend accessibility

### âš¡ `performance_validation.sh`
**Purpose:** Performance validation (auto-generated by deployment script)
- Tests API response times
- Validates FAISS query performance
- Measures forecast generation speed

### ğŸ”’ `security_validation.sh`
**Purpose:** Security validation (auto-generated by deployment script)
- Validates SSL certificates
- Checks security headers
- Verifies port exposure
- Tests security configurations

## Integration with Deployment System

These scripts are automatically:

1. **Created** by `./deploy-adelaide-weather.sh` during deployment
2. **Executed** as part of the deployment validation process
3. **Available** for manual execution and troubleshooting

## Validation Workflow

The deployment automation follows this validation sequence:

```
1. Prerequisites Check
   â”œâ”€â”€ Docker & Docker Compose
   â”œâ”€â”€ System Resources
   â”œâ”€â”€ Required Files
   â””â”€â”€ FAISS Data

2. Deployment Process
   â”œâ”€â”€ Environment Setup
   â”œâ”€â”€ SSL Certificate Generation
   â”œâ”€â”€ Service Orchestration
   â””â”€â”€ Health Validation

3. System Validation
   â”œâ”€â”€ Container Health
   â”œâ”€â”€ Endpoint Testing
   â”œâ”€â”€ FAISS Validation
   â””â”€â”€ Integration Testing

4. Performance & Security
   â”œâ”€â”€ Response Time Testing
   â”œâ”€â”€ Security Header Validation
   â”œâ”€â”€ Load Testing
   â””â”€â”€ End-to-End Workflows

5. Continuous Monitoring
   â”œâ”€â”€ Health Monitoring
   â”œâ”€â”€ Resource Monitoring
   â”œâ”€â”€ Performance Tracking
   â””â”€â”€ Alert Management
```

## Configuration

### Environment Variables
Scripts automatically load configuration from:
- `.env.production` - Main environment configuration
- Environment variables - Runtime overrides

### Customization Options
- **Health Check Intervals:** Modify monitoring frequency
- **Alert Thresholds:** Configure failure tolerance
- **Timeout Values:** Adjust for slower systems
- **Test Coverage:** Enable/disable specific test suites

## Troubleshooting

### Common Issues

1. **Prerequisites Failures:**
   ```bash
   # Check Docker status
   sudo systemctl status docker
   
   # Check available resources
   free -h && df -h
   
   # Test network connectivity
   curl -I https://registry-1.docker.io/v2/
   ```

2. **Health Check Failures:**
   ```bash
   # Check container status
   docker-compose -f docker-compose.production.yml ps
   
   # View service logs
   ./deploy-adelaide-weather.sh logs [service-name]
   
   # Manual health check
   curl -H "Authorization: Bearer $API_TOKEN" http://localhost/api/health
   ```

3. **Performance Issues:**
   ```bash
   # Check system resources
   docker stats
   
   # Monitor container logs
   ./deploy-adelaide-weather.sh logs api
   
   # Check FAISS indices
   ls -la indices/
   ```

### Log Files

Validation results are saved to:
- `deployment_logs/` - Deployment and validation logs
- `validation_scripts/health_report_*.json` - Health monitoring reports
- Container logs accessible via Docker Compose

## Automation Integration

These scripts are designed for:
- **CI/CD Pipelines:** Use exit codes for automated decision making
- **Monitoring Systems:** Parse JSON health reports
- **Alerting Systems:** Monitor log files and health endpoints
- **Load Balancers:** Use health endpoints for traffic routing

## Best Practices

1. **Run Prerequisites Check** before deployment
2. **Monitor Health Continuously** in production
3. **Run End-to-End Tests** after deployments
4. **Save Health Reports** for trend analysis
5. **Set Up Alerting** for critical failures

## Support

For issues or questions:
1. Check the main deployment logs: `deployment_logs/`
2. Run health monitor for detailed status: `python validation_scripts/health_monitor.py`
3. Use deployment script troubleshooting: `./deploy-adelaide-weather.sh --help`
4. Review the comprehensive deployment guide: `DEPLOYMENT_GUIDE.md`